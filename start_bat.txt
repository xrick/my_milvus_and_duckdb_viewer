@echo off
chcp 65001 >nul
title è³‡æ–™åº«æª¢è¦–å™¨

echo.
echo ================================================
echo          ğŸš€ è³‡æ–™åº«æª¢è¦–å™¨å•Ÿå‹•ç¨‹åº
echo ================================================
echo.

REM æª¢æŸ¥ Python æ˜¯å¦å®‰è£
python --version >nul 2>&1
if errorlevel 1 (
    echo âŒ Python æœªå®‰è£æˆ–æœªæ·»åŠ åˆ° PATH
    echo è«‹å…ˆå®‰è£ Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
    pause
    exit /b 1
)

echo âœ… æ‰¾åˆ° Python

REM æª¢æŸ¥æ˜¯å¦åœ¨è™›æ“¬ç’°å¢ƒä¸­
if exist "venv\Scripts\activate.bat" (
    echo ğŸ”§ ç™¼ç¾è™›æ“¬ç’°å¢ƒï¼Œæ­£åœ¨æ¿€æ´»...
    call venv\Scripts\activate.bat
    echo âœ… è™›æ“¬ç’°å¢ƒå·²æ¿€æ´»
) else (
    echo â„¹ï¸  æœªæ‰¾åˆ°è™›æ“¬ç’°å¢ƒï¼Œä½¿ç”¨å…¨å±€ Python ç’°å¢ƒ
    echo å»ºè­°å‰µå»ºè™›æ“¬ç’°å¢ƒ: python -m venv venv
)

REM æª¢æŸ¥ requirements.txt æ–‡ä»¶
if not exist "requirements.txt" (
    echo âŒ æ‰¾ä¸åˆ° requirements.txt æ–‡ä»¶
    pause
    exit /b 1
)

REM å®‰è£/æ›´æ–°ä¾è³´é …
echo.
echo ğŸ“¦ æª¢æŸ¥ä¸¦å®‰è£ä¾è³´é …...
pip install -r requirements.txt
if errorlevel 1 (
    echo âŒ ä¾è³´é …å®‰è£å¤±æ•—
    pause
    exit /b 1
)

REM æª¢æŸ¥ä¸»ç¨‹åºæ–‡ä»¶
if not exist "main.py" (
    echo âŒ æ‰¾ä¸åˆ° main.py æ–‡ä»¶
    pause
    exit /b 1
)

if not exist "start.py" (
    echo âŒ æ‰¾ä¸åˆ° start.py æ–‡ä»¶
    pause
    exit /b 1
)

REM å•Ÿå‹•æ‡‰ç”¨ç¨‹åº
echo.
echo ================================================
echo ğŸŒ æ­£åœ¨å•Ÿå‹•æœå‹™å™¨...
echo ğŸ“ æœå‹™å™¨åœ°å€: http://localhost:8000
echo ğŸ“š API æ–‡æª”: http://localhost:8000/docs  
echo ğŸ¥ å¥åº·æª¢æŸ¥: http://localhost:8000/health
echo ================================================
echo.
echo æŒ‰ Ctrl+C åœæ­¢æœå‹™å™¨
echo.

python start.py

echo.
echo ğŸ‘‹ æœå‹™å™¨å·²åœæ­¢
pause